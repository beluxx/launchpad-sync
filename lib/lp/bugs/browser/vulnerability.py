# Copyright 2022 Canonical Ltd. This software is licensed under the
# GNU Affero General Public License version 3 (see the file LICENSE).

"""Vulnerability views."""

__all__ = [
    "VulnerabilityIndexView",
]

from lp.bugs.browser.buglinktarget import BugLinksListingView
from lp.services.webapp.breadcrumb import TitleBreadcrumb


class VulnerabilityBreadcrumb(TitleBreadcrumb):
    pass


class VulnerabilityIndexView(BugLinksListingView):
    """Vulnerability index page."""

    @property
    def page_title(self):
        cve = self.context.cve
        if cve is not None:
            displayname = cve.displayname
        else:
            displayname = "Vulnerability"
        return "{} in the {} distribution".format(
            displayname, self.context.distribution.displayname
        )
