<tal:root
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    omit-tag="">

<table>
  <tr>
    <td>
      <p class="formHelp">
        Channels to release this snap package to after uploading it to the
        store.  A channel is defined by a combination of an optional track,
        a risk, and an optional branch, e.g. '2.1/stable/fix-123',
        '2.1/stable', 'stable/fix-123', or 'stable'.
        <a href="https://docs.snapcraft.io/reference/channels"
           target="_blank"
           class="sprite maybe action-icon">(?)</a>
      </p>
    </td>
  </tr>
  <tr>
    <td>
      <table class="subordinate">
        <tr>
          <td>
            <tal:widget define="widget nocall:view/add_risk_widget">
              <metal:block
                use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
            </tal:widget>
          </td>
          <td>
            <tal:widget define="widget nocall:view/add_track_widget">
              <metal:block
                  use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
            </tal:widget>
            <p class="formHelp">
                To open a new track, <a href="https://snapcraft.io/community">ask the store admins</a>.
            </p>
          </td>
          <td>
            <tal:widget define="widget nocall:view/add_branch_widget">
              <metal:block
                  use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
            </tal:widget>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr tal:condition="view/is_edit">
      <table class="subordinate"
        tal:repeat="channel_index python:range(len(view.context.context.store_channels))">
            <tal:edit_store_widgets
                define="parity python:'even' if repeat['channel_index'].even() else 'odd';
                        edit_track string:track_${channel_index}_widget;
                        edit_branch string:branch_${channel_index}_widget;
                        edit_risk string:risk_${channel_index}_widget;
                        delete string:delete_${channel_index}_widget">
              <tr tal:attributes="class string:channel-row ${parity}">
                <td class="channel-row-branch"
                    tal:define="widget nocall:view/?edit_risk">
                  <metal:block
                      use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
                </td>
                <td class="channel-row-track"
                    tal:define="widget nocall:view/?edit_track">
                  <metal:block
                      use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
                </td>
                <td class="channel-row-branch"
                    tal:define="widget nocall:view/?edit_branch">
                  <metal:block
                      use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
                </td>
                <td class="channel-row-delete"
                    tal:define="widget nocall:view/?delete">
                  <metal:block
                      use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
                </td>
              </tr>
            </tal:edit_store_widgets>
      </table>
  </tr>
</table>

</tal:root>
